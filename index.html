<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–û–ì–û–î–ê | WEATHER</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background 0.3s ease, color 0.2s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 16px;
            min-height: 100vh;
        }

        /* –¢–ï–ú–ù–ê –¢–ï–ú–ê */
        body.dark {
            background: #0b0e14;
            color: white;
        }

        body.dark .card {
            background: linear-gradient(145deg, #1e222a, #15181f);
            box-shadow: 0 8px 0 #0a0c10;
        }

        body.dark .search-input {
            background: #0b0e14;
            color: white;
            border: 1px solid #2a2f38;
        }

        body.dark .city-tag {
            background: #0b0e14;
            color: #8e98a3;
        }

        body.dark .city-tag:hover,
        body.dark .city-tag.active {
            background: #2a7f6e;
            color: white;
        }

        body.dark .detail-item {
            background: #0b0e14;
        }

        body.dark .time,
        body.dark .section-title,
        body.dark .detail-label,
        body.dark .status {
            color: #8e98a3;
        }

        /* –°–í–Ü–¢–õ–ê –¢–ï–ú–ê */
        body.light {
            background: #f5f7fa;
            color: #1a1e24;
        }

        body.light .card {
            background: linear-gradient(145deg, #ffffff, #f0f2f5);
            box-shadow: 0 8px 0 #d0d4da;
            border: 1px solid rgba(0,0,0,0.05);
        }

        body.light .search-input {
            background: #ffffff;
            color: #1a1e24;
            border: 1px solid #e0e4e9;
        }

        body.light .city-tag {
            background: #ffffff;
            color: #4a525c;
            border: 1px solid #e0e4e9;
        }

        body.light .city-tag:hover,
        body.light .city-tag.active {
            background: #2a7f6e;
            color: white;
            border-color: #2a7f6e;
        }

        body.light .detail-item {
            background: #ffffff;
            border: 1px solid #e0e4e9;
        }

        body.light .time,
        body.light .section-title,
        body.light .detail-label,
        body.light .status {
            color: #6b7280;
        }

        body.light .balance {
            background: #e8ecf0;
            color: #1a1e24;
        }

        .app {
            max-width: 380px;
            margin: 0 auto;
        }

        /* –•–µ–¥–µ—Ä */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .time {
            font-size: 17px;
            font-weight: 600;
        }

        .balance {
            background: #1e222a;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ç–µ–º–∏ */
        .theme-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        body.dark .theme-btn {
            color: #ffd700;
        }

        body.light .theme-btn {
            color: #6b7280;
        }

        /* –ö–∞—Ä—Ç–∫–∞ –ø–æ–≥–æ–¥–∏ */
        .card {
            border-radius: 30px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .city-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .city {
            font-size: 24px;
            font-weight: 700;
        }

        .weather-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: #2a7f6e;
            text-decoration: none;
            font-weight: 600;
            font-size: 15px;
        }

        body.light .weather-link {
            color: #1e5f4f;
        }

        .temp-big {
            font-size: 64px;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 12px;
        }

        .weather-desc {
            font-size: 17px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.9;
        }

        /* –î–µ—Ç–∞–ª—ñ */
        .details-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .detail-item {
            padding: 16px 12px;
            border-radius: 20px;
            text-align: center;
        }

        .detail-label {
            font-size: 13px;
            margin-bottom: 6px;
        }

        .detail-value {
            font-size: 18px;
            font-weight: 700;
        }

        /* –ü–æ—à—É–∫ */
        .search-section {
            background: transparent;
            border-radius: 30px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 15px;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-input {
            width: 100%;
            border: none;
            border-radius: 20px;
            padding: 16px 20px;
            font-size: 17px;
            margin-bottom: 16px;
        }

        .search-input::placeholder {
            color: #8e98a3;
        }

        .search-btn {
            width: 100%;
            background: #2a7f6e;
            border: none;
            border-radius: 20px;
            padding: 16px;
            color: white;
            font-weight: 700;
            font-size: 17px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 6px 0 #1a4f43;
        }

        .search-btn:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        /* –®–≤–∏–¥–∫—ñ –º—ñ—Å—Ç–∞ */
        .cities-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 16px;
        }

        .city-tag {
            padding: 12px 8px;
            border-radius: 16px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        /* –°—Ç–∞—Ç—É—Å */
        .status {
            text-align: center;
            font-size: 13px;
            margin-top: 20px;
            padding: 16px;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        /* –£–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –ø—Ä–∞–ø–æ—Ä */
        .ua-flag {
            display: inline-block;
            width: 20px;
            height: 20px;
            background: linear-gradient(to bottom, #0057b7 50%, #ffd700 50%);
            border-radius: 4px;
            margin-right: 4px;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 12px;
            opacity: 0.7;
        }
    </style>
</head>
<body class="dark">
    <div class="app">
        <!-- –•–µ–¥–µ—Ä –∑ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–º –∞–∫—Ü–µ–Ω—Ç–æ–º -->
        <div class="header">
            <span class="time" id="currentTime">12:33</span>
            <div style="display: flex; gap: 8px;">
                <button class="theme-btn" onclick="toggleTheme()" id="themeToggle">üåô</button>
                <span class="balance">üá∫üá¶ Weather UA</span>
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–∫–∞ –ø–æ–≥–æ–¥–∏ -->
        <div class="card" id="weatherCard">
            <div class="city-row">
                <span class="city" id="cityName">–ö–∏—ó–≤</span>
                <span class="weather-link">üìé –ü–æ–≥–æ–¥–∞</span>
            </div>
            <div class="temp-big" id="temperature">22¬∞</div>
            <div class="weather-desc" id="description">
                <span>‚òÄÔ∏è</span>
                <span>–°–æ–Ω—è—á–Ω–æ</span>
            </div>
            
            <div class="details-grid">
                <div class="detail-item">
                    <div class="detail-label">–í—ñ–¥—á—É–≤–∞—î—Ç—å—Å—è</div>
                    <div class="detail-value" id="feelsLike">20¬∞</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">–í—ñ—Ç–µ—Ä</div>
                    <div class="detail-value" id="wind">5 –º/—Å</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">–í–æ–ª–æ–≥—ñ—Å—Ç—å</div>
                    <div class="detail-value" id="humidity">65%</div>
                </div>
            </div>
        </div>

        <!-- –ü–æ—à—É–∫ –ø–æ–≥–æ–¥–∏ -->
        <div class="search-section">
            <div class="section-title">
                <span>üå§Ô∏è</span>
                <span>–ü–û–ì–û–î–ê –í –£–ö–†–ê–á–ù–Ü –¢–ê –°–í–Ü–¢–Ü</span>
            </div>
            
            <input type="text" class="search-input" id="cityInput" placeholder="–í–≤–µ–¥–∏ –Ω–∞–∑–≤—É –º—ñ—Å—Ç–∞..." value="–ö–∏—ó–≤">
            
            <button class="search-btn" onclick="getWeather()">
                <span>üîç</span>
                <span>–î–Ü–ó–ù–ê–¢–ò–°–¨ –ü–û–ì–û–î–£</span>
            </button>

            <!-- –®–≤–∏–¥–∫—ñ –º—ñ—Å—Ç–∞ –£–∫—Ä–∞—ó–Ω–∏ -->
            <div style="margin-top: 20px; margin-bottom: 10px; color: #8e98a3; font-size: 13px;">
                üá∫üá¶ –ú–Ü–°–¢–ê –£–ö–†–ê–á–ù–ò
            </div>
            <div class="cities-grid">
                <div class="city-tag active" onclick="selectCity('Kyiv')">–ö–∏—ó–≤</div>
                <div class="city-tag" onclick="selectCity('Lviv')">–õ—å–≤—ñ–≤</div>
                <div class="city-tag" onclick="selectCity('Odesa')">–û–¥–µ—Å–∞</div>
                <div class="city-tag" onclick="selectCity('Kharkiv')">–•–∞—Ä–∫—ñ–≤</div>
                <div class="city-tag" onclick="selectCity('Dnipro')">–î–Ω—ñ–ø—Ä–æ</div>
                <div class="city-tag" onclick="selectCity('Zaporizhzhia')">–ó–∞–ø–æ—Ä—ñ–∂–∂—è</div>
                <div class="city-tag" onclick="selectCity('Vinnytsia')">–í—ñ–Ω–Ω–∏—Ü—è</div>
                <div class="city-tag" onclick="selectCity('Poltava')">–ü–æ–ª—Ç–∞–≤–∞</div>
            </div>

            <!-- –°–≤—ñ—Ç–æ–≤—ñ –º—ñ—Å—Ç–∞ -->
            <div style="margin-top: 20px; margin-bottom: 10px; color: #8e98a3; font-size: 13px;">
                üåç –°–í–Ü–¢–û–í–Ü –ú–Ü–°–¢–ê
            </div>
            <div class="cities-grid">
                <div class="city-tag" onclick="selectCity('London')">–õ–æ–Ω–¥–æ–Ω</div>
                <div class="city-tag" onclick="selectCity('Paris')">–ü–∞—Ä–∏–∂</div>
                <div class="city-tag" onclick="selectCity('New York')">–ù—å—é-–ô–æ—Ä–∫</div>
                <div class="city-tag" onclick="selectCity('Tokyo')">–¢–æ–∫—ñ–æ</div>
                <div class="city-tag" onclick="selectCity('Berlin')">–ë–µ—Ä–ª—ñ–Ω</div>
                <div class="city-tag" onclick="selectCity('Warsaw')">–í–∞—Ä—à–∞–≤–∞</div>
                <div class="city-tag" onclick="selectCity('Rome')">–†–∏–º</div>
                <div class="city-tag" onclick="selectCity('Barcelona')">–ë–∞—Ä—Å–µ–ª–æ–Ω–∞</div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -->
        <div class="status" id="status">
            üìé –ü–æ–≥–æ–¥–∞ –£–∫—Ä–∞—ó–Ω–∞ ¬∑ –û–Ω–æ–≤–ª–µ–Ω–æ —â–æ–π–Ω–æ
        </div>
        
        <div class="footer">
            üå§Ô∏è Weather Mini App ¬∑ –ó—Ä–æ–±–ª–µ–Ω–æ –≤ –£–∫—Ä–∞—ó–Ω—ñ üá∫üá¶
        </div>
    </div>

    <script>
        // –¢–í–Ü–ô API –ö–õ–Æ–ß
        const API_KEY = "0f8d4d200034367f49673052d36188f1";

        // Telegram Web App
        if (window.Telegram?.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }

        // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–µ–º–∏
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('dark')) {
                body.classList.remove('dark');
                body.classList.add('light');
                themeToggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light');
                body.classList.add('dark');
                themeToggle.textContent = 'üåô';
                localStorage.setItem('theme', 'dark');
            }
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∑–±–µ—Ä–µ–∂–µ–Ω—É —Ç–µ–º—É
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.body.classList.add(savedTheme);
        document.getElementById('themeToggle').textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —á–∞—Å—É
        function updateTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('currentTime').textContent = `${hours}:${minutes}`;
        }
        updateTime();
        setInterval(updateTime, 60000);

        // –í–∏–±—ñ—Ä –º—ñ—Å—Ç–∞
        function selectCity(city) {
            document.getElementById('cityInput').value = city;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å
            document.querySelectorAll('.city-tag').forEach(tag => {
                tag.classList.remove('active');
                if (tag.textContent.includes(city) || 
                    (city === 'Kyiv' && tag.textContent === '–ö–∏—ó–≤') ||
                    (city === 'Lviv' && tag.textContent === '–õ—å–≤—ñ–≤') ||
                    (city === 'Odesa' && tag.textContent === '–û–¥–µ—Å–∞') ||
                    (city === 'New York' && tag.textContent === '–ù—å—é-–ô–æ—Ä–∫') ||
                    (city === 'Tokyo' && tag.textContent === '–¢–æ–∫—ñ–æ')) {
                    tag.classList.add('active');
                }
            });
            
            getWeather();
        }

        // –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≥–æ–¥—É
        async function getWeather() {
            let city = document.getElementById('cityInput').value.trim();
            if (!city) city = 'Kyiv';

            // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –Ω–∞–∑–≤ –¥–ª—è API
            let apiCity = city;
            const cityMap = {
                '–ö–∏—ó–≤': 'Kyiv',
                '–õ—å–≤—ñ–≤': 'Lviv',
                '–û–¥–µ—Å–∞': 'Odesa',
                '–•–∞—Ä–∫—ñ–≤': 'Kharkiv',
                '–î–Ω—ñ–ø—Ä–æ': 'Dnipro',
                '–ó–∞–ø–æ—Ä—ñ–∂–∂—è': 'Zaporizhzhia',
                '–í—ñ–Ω–Ω–∏—Ü—è': 'Vinnytsia',
                '–ü–æ–ª—Ç–∞–≤–∞': 'Poltava',
                '–õ–æ–Ω–¥–æ–Ω': 'London',
                '–ü–∞—Ä–∏–∂': 'Paris',
                '–ù—å—é-–ô–æ—Ä–∫': 'New York',
                '–¢–æ–∫—ñ–æ': 'Tokyo',
                '–ë–µ—Ä–ª—ñ–Ω': 'Berlin',
                '–í–∞—Ä—à–∞–≤–∞': 'Warsaw',
                '–†–∏–º': 'Rome',
                '–ë–∞—Ä—Å–µ–ª–æ–Ω–∞': 'Barcelona'
            };
            
            if (cityMap[city]) {
                apiCity = cityMap[city];
            }
            
            document.getElementById('status').innerHTML = '‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...';

            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${apiCity}&appid=${API_KEY}&units=metric&lang=uk`
                );
                
                if (!response.ok) throw new Error('–ú—ñ—Å—Ç–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
                
                const data = await response.json();
                
                // –û–Ω–æ–≤–ª—é—î–º–æ UI
                document.getElementById('cityName').textContent = city;
                document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}¬∞`;
                document.getElementById('feelsLike').textContent = `${Math.round(data.main.feels_like)}¬∞`;
                document.getElementById('wind').textContent = `${data.wind.speed} –º/—Å`;
                document.getElementById('humidity').textContent = `${data.main.humidity}%`;
                
                // –ï–º–æ–¥–∑—ñ –ø–æ–≥–æ–¥–∏
                const weatherId = data.weather[0].id;
                let emoji = '‚òÄÔ∏è';
                let desc = data.weather[0].description;
                
                if (weatherId >= 200 && weatherId < 300) {
                    emoji = '‚õàÔ∏è';
                    desc = '–ì—Ä–æ–∑–∞';
                } else if (weatherId >= 300 && weatherId < 400) {
                    emoji = 'üåßÔ∏è';
                    desc = '–ú—Ä—è–∫–∞';
                } else if (weatherId >= 500 && weatherId < 600) {
                    emoji = 'üå¶Ô∏è';
                    desc = '–î–æ—â';
                } else if (weatherId >= 600 && weatherId < 700) {
                    emoji = '‚ùÑÔ∏è';
                    desc = '–°–Ω—ñ–≥';
                } else if (weatherId >= 700 && weatherId < 800) {
                    emoji = 'üå´Ô∏è';
                    desc = '–¢—É–º–∞–Ω';
                } else if (weatherId === 800) {
                    emoji = '‚òÄÔ∏è';
                    desc = '–Ø—Å–Ω–æ';
                } else if (weatherId > 800) {
                    emoji = '‚òÅÔ∏è';
                    desc = '–•–º–∞—Ä–Ω–æ';
                }
                
                document.getElementById('description').innerHTML = 
                    `<span>${emoji}</span><span>${desc}</span>`;
                
                document.getElementById('status').innerHTML = 'üìé –ü–æ–≥–æ–¥–∞ –£–∫—Ä–∞—ó–Ω–∞ ¬∑ –û–Ω–æ–≤–ª–µ–Ω–æ —â–æ–π–Ω–æ';
                
                // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤ Telegram
                if (window.Telegram?.WebApp) {
                    Telegram.WebApp.sendData(JSON.stringify({
                        city: city,
                        temp: Math.round(data.main.temp),
                        weather: desc,
                        country: 'UA'
                    }));
                }
                
            } catch (error) {
                document.getElementById('status').innerHTML = '‚ùå –ú—ñ—Å—Ç–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ';
                document.getElementById('cityName').textContent = '–ü–æ–º–∏–ª–∫–∞';
                document.getElementById('temperature').textContent = '--¬∞';
            }
        }

        // Enter
        document.getElementById('cityInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') getWeather();
        });

        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø–æ–≥–æ–¥—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
        window.onload = () => {
            selectCity('Kyiv');
        };
    </script>
</body>
</html>

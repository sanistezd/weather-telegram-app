<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEATHER ¬∑ –ø–æ–≥–æ–¥–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0b0e14;
            color: #ffffff;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 400px;
            width: 100%;
            margin: 0 auto;
        }

        /* –¢–µ–º–∞ */
        body.light {
            background: #f8f9fc;
            color: #1a1e24;
        }

        body.light .card {
            background: #ffffff;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
        }

        body.light .search-input {
            background: #f0f3f7;
            color: #1a1e24;
        }

        body.light .detail-item {
            background: #f0f3f7;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 18px;
            color: #8e98a3;
        }

        .theme-btn {
            background: none;
            border: none;
            font-size: 22px;
            cursor: pointer;
            padding: 8px;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .theme-btn:hover {
            opacity: 1;
        }

        /* –ö–∞—Ä—Ç–∫–∞ –ø–æ–≥–æ–¥–∏ */
        .card {
            background: #1e222a;
            border-radius: 28px;
            padding: 32px 24px;
            margin-bottom: 20px;
        }

        .city {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .temp {
            font-size: 72px;
            font-weight: 800;
            line-height: 1;
            margin: 16px 0 8px;
        }

        .desc {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            color: #8e98a3;
            margin-bottom: 32px;
        }

        /* –î–µ—Ç–∞–ª—ñ */
        .details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .detail-item {
            background: #0b0e14;
            padding: 16px 12px;
            border-radius: 18px;
            text-align: center;
        }

        .detail-label {
            font-size: 13px;
            color: #8e98a3;
            margin-bottom: 6px;
        }

        .detail-value {
            font-size: 18px;
            font-weight: 700;
        }

        /* –ü–æ—à—É–∫ */
        .search-section {
            background: #1e222a;
            border-radius: 28px;
            padding: 24px;
        }

        .search-title {
            color: #8e98a3;
            font-size: 14px;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .search-input {
            width: 100%;
            background: #0b0e14;
            border: none;
            border-radius: 18px;
            padding: 18px 20px;
            color: #ffffff;
            font-size: 17px;
            margin-bottom: 16px;
        }

        .search-input::placeholder {
            color: #4a525c;
        }

        .search-btn {
            width: 100%;
            background: #2a7f6e;
            border: none;
            border-radius: 18px;
            padding: 18px;
            color: white;
            font-weight: 700;
            font-size: 17px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .search-btn:hover {
            background: #1e5f52;
        }

        .search-btn:active {
            transform: scale(0.98);
        }

        /* –°—Ç–∞—Ç—É—Å */
        .status {
            text-align: center;
            margin-top: 20px;
            color: #8e98a3;
            font-size: 13px;
            padding: 8px;
        }

        /* –°–≤—ñ—Ç–ª–∞ —Ç–µ–º–∞ */
        body.light .card,
        body.light .search-section {
            background: #ffffff;
        }

        body.light .detail-item {
            background: #f0f3f7;
        }

        body.light .search-input {
            background: #f0f3f7;
            color: #1a1e24;
        }

        body.light .logo {
            color: #6b7280;
        }

        /* –ê–Ω—ñ–º–∞—Ü—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }
    </style>
</head>
<body class="dark">
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="logo">
                <span>üå§Ô∏è</span>
                <span>weather</span>
            </div>
            <button class="theme-btn" onclick="toggleTheme()" id="themeToggle">üåô</button>
        </div>

        <!-- –ö–∞—Ä—Ç–∫–∞ –ø–æ–≥–æ–¥–∏ -->
        <div class="card" id="weatherCard">
            <div class="city" id="cityName">–ö–∏—ó–≤</div>
            <div class="temp" id="temperature">22¬∞</div>
            <div class="desc" id="description">
                <span>‚òÄÔ∏è</span>
                <span>–°–æ–Ω—è—á–Ω–æ</span>
            </div>
            
            <div class="details">
                <div class="detail-item">
                    <div class="detail-label">–í—ñ–¥—á—É–≤–∞—î—Ç—å—Å—è</div>
                    <div class="detail-value" id="feelsLike">20¬∞</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">–í—ñ—Ç–µ—Ä</div>
                    <div class="detail-value" id="wind">5 –º/—Å</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">–í–æ–ª–æ–≥—ñ—Å—Ç—å</div>
                    <div class="detail-value" id="humidity">65%</div>
                </div>
            </div>
        </div>

        <!-- –ü–æ—à—É–∫ ‚Äî —Ç—ñ–ª—å–∫–∏ –ø–æ–ª–µ —Ç–∞ –∫–Ω–æ–ø–∫–∞! -->
        <div class="search-section">
            <div class="search-title">üîç –ü–û–®–£–ö –ú–Ü–°–¢–ê</div>
            <input 
                type="text" 
                class="search-input" 
                id="cityInput" 
                placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ö–∏—ó–≤, –õ—å–≤—ñ–≤, London"
                value="–ö–∏—ó–≤"
                autocomplete="off"
                autofocus
            >
            <button class="search-btn" onclick="getWeather()">
                <span>üå§Ô∏è</span>
                <span>–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≥–æ–¥—É</span>
            </button>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å -->
        <div class="status" id="status">
            üá∫üá¶ Weather ¬∑ —Ä–µ–∞–ª—å–Ω–∞ –ø–æ–≥–æ–¥–∞
        </div>
    </div>

    <script>
        // –¢–í–Ü–ô API –ö–õ–Æ–ß
        const API_KEY = "0f8d4d200034367f49673052d36188f1";

        // Telegram Web App
        if (window.Telegram?.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }

        // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–µ–º–∏
        function toggleTheme() {
            const body = document.body;
            const toggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('dark')) {
                body.classList.remove('dark');
                body.classList.add('light');
                toggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light');
                body.classList.add('dark');
                toggle.textContent = 'üåô';
                localStorage.setItem('theme', 'dark');
            }
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–µ–º—É
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.body.classList.add(savedTheme);
        document.getElementById('themeToggle').textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';

        // –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≥–æ–¥—É
        async function getWeather() {
            let city = document.getElementById('cityInput').value.trim();
            if (!city) {
                city = 'Kyiv';
                document.getElementById('cityInput').value = '–ö–∏—ó–≤';
            }

            // –ú–∞–ø–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö –º—ñ—Å—Ç
            const cityMap = {
                '–∫–∏—ó–≤': 'Kyiv', 'kiev': 'Kyiv', 'kyiv': 'Kyiv',
                '–ª—å–≤—ñ–≤': 'Lviv', 'lviv': 'Lviv',
                '–æ–¥–µ—Å–∞': 'Odesa', 'odesa': 'Odesa', 'odessa': 'Odesa',
                '—Ö–∞—Ä–∫—ñ–≤': 'Kharkiv', 'kharkiv': 'Kharkiv',
                '–¥–Ω—ñ–ø—Ä–æ': 'Dnipro', 'dnipro': 'Dnipro',
                '–ª–æ–Ω–¥–æ–Ω': 'London', 'london': 'London',
                '–ø–∞—Ä–∏–∂': 'Paris', 'paris': 'Paris',
                '–±–µ—Ä–ª—ñ–Ω': 'Berlin', 'berlin': 'Berlin',
                '–≤–∞—Ä—à–∞–≤–∞': 'Warsaw', 'warsaw': 'Warsaw',
                '–ø—Ä–∞–≥–∞': 'Prague', 'prague': 'Prague',
                '–≤—ñ–¥–µ–Ω—å': 'Vienna', 'vienna': 'Vienna'
            };

            let searchCity = cityMap[city.toLowerCase()] || city;
            
            // –°—Ç–∞—Ç—É—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            const statusEl = document.getElementById('status');
            statusEl.innerHTML = '‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...';
            statusEl.classList.add('loading');

            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${searchCity}&appid=${API_KEY}&units=metric&lang=uk`
                );
                
                if (!response.ok) throw new Error('–ú—ñ—Å—Ç–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
                
                const data = await response.json();
                
                // –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ –Ω–∞–∑–≤—É –º—ñ—Å—Ç–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é
                let displayCity = city;
                for (let [uk, en] of Object.entries(cityMap)) {
                    if (en.toLowerCase() === searchCity.toLowerCase()) {
                        displayCity = uk.charAt(0).toUpperCase() + uk.slice(1);
                        break;
                    }
                }
                
                // –û–Ω–æ–≤–ª—é—î–º–æ UI
                document.getElementById('cityName').textContent = displayCity;
                document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}¬∞`;
                document.getElementById('feelsLike').textContent = `${Math.round(data.main.feels_like)}¬∞`;
                document.getElementById('wind').textContent = `${data.wind.speed} –º/—Å`;
                document.getElementById('humidity').textContent = `${data.main.humidity}%`;
                
                // –ï–º–æ–¥–∑—ñ –ø–æ–≥–æ–¥–∏
                const weatherId = data.weather[0].id;
                let emoji = '‚òÄÔ∏è';
                let desc = data.weather[0].description.charAt(0).toUpperCase() + data.weather[0].description.slice(1);
                
                if (weatherId >= 200 && weatherId < 300) { emoji = '‚õàÔ∏è'; desc = '–ì—Ä–æ–∑–∞'; }
                else if (weatherId >= 300 && weatherId < 400) { emoji = 'üåßÔ∏è'; desc = '–ú—Ä—è–∫–∞'; }
                else if (weatherId >= 500 && weatherId < 600) { emoji = 'üå¶Ô∏è'; desc = '–î–æ—â'; }
                else if (weatherId >= 600 && weatherId < 700) { emoji = '‚ùÑÔ∏è'; desc = '–°–Ω—ñ–≥'; }
                else if (weatherId >= 700 && weatherId < 800) { emoji = 'üå´Ô∏è'; desc = '–¢—É–º–∞–Ω'; }
                else if (weatherId === 800) { emoji = '‚òÄÔ∏è'; desc = '–Ø—Å–Ω–æ'; }
                else if (weatherId > 800) { emoji = '‚òÅÔ∏è'; desc = '–•–º–∞—Ä–Ω–æ'; }
                
                document.getElementById('description').innerHTML = 
                    `<span>${emoji}</span><span>${desc}</span>`;
                
                statusEl.innerHTML = 'üá∫üá¶ Weather ¬∑ –æ–Ω–æ–≤–ª–µ–Ω–æ —â–æ–π–Ω–æ';
                statusEl.classList.remove('loading');
                
                // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤ Telegram
                if (window.Telegram?.WebApp) {
                    Telegram.WebApp.sendData(JSON.stringify({
                        city: displayCity,
                        temp: Math.round(data.main.temp),
                        weather: desc
                    }));
                }
                
            } catch (error) {
                statusEl.innerHTML = '‚ùå –ú—ñ—Å—Ç–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ';
                statusEl.classList.remove('loading');
                
                document.getElementById('cityName').textContent = '‚Äî';
                document.getElementById('temperature').textContent = '--¬∞';
                document.getElementById('description').innerHTML = 
                    `<span>‚ùì</span><span>–°–ø—Ä–æ–±—É–π—Ç–µ —â–µ</span>`;
            }
        }

        // –ü–æ—à—É–∫ –ø–æ Enter
        document.getElementById('cityInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                getWeather();
            }
        });

        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å
        window.onload = () => {
            document.getElementById('cityInput').focus();
            getWeather();
        };
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEATHER</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background 0.3s ease, color 0.2s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 16px;
            min-height: 100vh;
        }

        /* –¢–ï–ú–ù–ê–Ø –¢–ï–ú–ê (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
        body.dark {
            background: #0b0e14;
            color: white;
        }

        body.dark .card {
            background: linear-gradient(145deg, #1e222a, #15181f);
            box-shadow: 0 8px 0 #0a0c10;
        }

        body.dark .search-input {
            background: #0b0e14;
            color: white;
        }

        body.dark .city-tag {
            background: #0b0e14;
            color: #8e98a3;
        }

        body.dark .city-tag:hover,
        body.dark .city-tag.active {
            background: #2a7f6e;
            color: white;
        }

        body.dark .detail-item {
            background: #0b0e14;
        }

        body.dark .time,
        body.dark .section-title,
        body.dark .detail-label,
        body.dark .status {
            color: #8e98a3;
        }

        /* –°–í–ï–¢–õ–ê–Ø –¢–ï–ú–ê */
        body.light {
            background: #f5f7fa;
            color: #1a1e24;
        }

        body.light .card {
            background: linear-gradient(145deg, #ffffff, #f0f2f5);
            box-shadow: 0 8px 0 #d0d4da;
            border: 1px solid rgba(0,0,0,0.05);
        }

        body.light .search-input {
            background: #ffffff;
            color: #1a1e24;
            border: 1px solid #e0e4e9;
        }

        body.light .city-tag {
            background: #ffffff;
            color: #4a525c;
            border: 1px solid #e0e4e9;
        }

        body.light .city-tag:hover,
        body.light .city-tag.active {
            background: #2a7f6e;
            color: white;
            border-color: #2a7f6e;
        }

        body.light .detail-item {
            background: #ffffff;
            border: 1px solid #e0e4e9;
        }

        body.light .time,
        body.light .section-title,
        body.light .detail-label {
            color: #6b7280;
        }

        body.light .status {
            color: #6b7280;
        }

        body.light .search-btn {
            color: white;
        }

        body.light .balance {
            background: #e8ecf0;
            color: #1a1e24;
        }

        .app {
            max-width: 380px;
            margin: 0 auto;
        }

        /* –•–µ–¥–µ—Ä */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .time {
            font-size: 17px;
            font-weight: 600;
        }

        .balance {
            background: #1e222a;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 15px;
            font-weight: 600;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ç–µ–º—ã */
        .theme-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        body.dark .theme-btn {
            color: #ffd700;
        }

        body.light .theme-btn {
            color: #6b7280;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–≥–æ–¥—ã */
        .card {
            border-radius: 30px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .city-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .city {
            font-size: 24px;
            font-weight: 700;
        }

        .temp-big {
            font-size: 64px;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 12px;
        }

        .weather-desc {
            font-size: 17px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.9;
        }

        /* –î–µ—Ç–∞–ª–∏ */
        .details-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .detail-item {
            padding: 16px 12px;
            border-radius: 20px;
            text-align: center;
        }

        .detail-label {
            font-size: 13px;
            margin-bottom: 6px;
        }

        .detail-value {
            font-size: 18px;
            font-weight: 700;
        }

        /* –ü–æ–∏—Å–∫ */
        .search-section {
            background: transparent;
            border-radius: 30px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 15px;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .search-input {
            width: 100%;
            border: none;
            border-radius: 20px;
            padding: 16px 20px;
            font-size: 17px;
            margin-bottom: 16px;
        }

        .search-input::placeholder {
            color: #8e98a3;
        }

        .search-btn {
            width: 100%;
            background: #2a7f6e;
            border: none;
            border-radius: 20px;
            padding: 16px;
            color: white;
            font-weight: 700;
            font-size: 17px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 6px 0 #1a4f43;
        }

        .search-btn:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        /* –ë—ã—Å—Ç—Ä—ã–µ –≥–æ—Ä–æ–¥–∞ */
        .cities-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 16px;
        }

        .city-tag {
            padding: 12px 8px;
            border-radius: 16px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        /* –°—Ç–∞—Ç—É—Å */
        .status {
            text-align: center;
            font-size: 13px;
            margin-top: 20px;
            padding: 16px;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        /* –°–∫—Ä–µ–ø–∫–∞ –∏ —Å—Å—ã–ª–∫–∞ */
        .gift-link {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: #2a7f6e;
            text-decoration: none;
            font-weight: 600;
        }

        body.light .gift-link {
            color: #1e5f4f;
        }
    </style>
</head>
<body class="dark">
    <div class="app">
        <!-- –•–µ–¥–µ—Ä —Å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–º —Ç–µ–º—ã -->
        <div class="header">
            <span class="time" id="currentTime">12:33</span>
            <div style="display: flex; gap: 8px;">
                <button class="theme-btn" onclick="toggleTheme()" id="themeToggle">üåô</button>
                <span class="balance">üìé Weather</span>
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–≥–æ–¥—ã -->
        <div class="card" id="weatherCard">
            <div class="city-row">
                <span class="city" id="cityName">Kyiv</span>
                <span class="gift-link">üìé Weather</span>
            </div>
            <div class="temp-big" id="temperature">22¬∞</div>
            <div class="weather-desc" id="description">
                <span>‚òÄÔ∏è</span>
                <span>Sunny</span>
            </div>
            
            <div class="details-grid">
                <div class="detail-item">
                    <div class="detail-label">Feels like</div>
                    <div class="detail-value" id="feelsLike">20¬∞</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Wind</div>
                    <div class="detail-value" id="wind">5 m/s</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Humidity</div>
                    <div class="detail-value" id="humidity">65%</div>
                </div>
            </div>
        </div>

        <!-- –ü–æ–∏—Å–∫ -->
        <div class="search-section">
            <div class="section-title">üå§Ô∏è WEATHER FORECAST</div>
            <input type="text" class="search-input" id="cityInput" placeholder="Enter city name" value="Kyiv">
            <button class="search-btn" onclick="getWeather()">
                <span>üîç</span>
                <span>Check Weather</span>
            </button>

            <!-- –ë—ã—Å—Ç—Ä—ã–µ –≥–æ—Ä–æ–¥–∞ -->
            <div class="cities-grid">
                <div class="city-tag active" onclick="selectCity('Kyiv')">Kyiv</div>
                <div class="city-tag" onclick="selectCity('London')">London</div>
                <div class="city-tag" onclick="selectCity('New York')">NYC</div>
                <div class="city-tag" onclick="selectCity('Tokyo')">Tokyo</div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å -->
        <div class="status" id="status">
            üìé Weather ¬∑ Updated just now
        </div>
    </div>

    <script>
        // –¢–í–û–ô API –ö–õ–Æ–ß
        const API_KEY = "0f8d4d200034367f49673052d36188f1";

        // Telegram Web App
        if (window.Telegram?.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('dark')) {
                body.classList.remove('dark');
                body.classList.add('light');
                themeToggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light');
                body.classList.add('dark');
                themeToggle.textContent = 'üåô';
                localStorage.setItem('theme', 'dark');
            }
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.body.classList.add(savedTheme);
        document.getElementById('themeToggle').textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';

        // –í—Ä–µ–º—è
        function updateTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('currentTime').textContent = `${hours}:${minutes}`;
        }
        updateTime();
        setInterval(updateTime, 60000);

        // –í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞
        function selectCity(city) {
            document.getElementById('cityInput').value = city;
            document.querySelectorAll('.city-tag').forEach(tag => {
                tag.classList.remove('active');
                if (tag.textContent === city || 
                    (city === 'New York' && tag.textContent === 'NYC') ||
                    (city === 'NYC' && tag.textContent === 'NYC')) {
                    tag.classList.add('active');
                }
            });
            getWeather();
        }

        // –ü–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É
        async function getWeather() {
            let city = document.getElementById('cityInput').value.trim();
            if (!city) city = 'Kyiv';

            let apiCity = city;
            if (city === 'NYC') apiCity = 'New York';
            
            document.getElementById('status').innerHTML = '‚è≥ Loading...';

            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${apiCity}&appid=${API_KEY}&units=metric`
                );
                
                if (!response.ok) throw new Error('City not found');
                
                const data = await response.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                document.getElementById('cityName').textContent = data.name;
                document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}¬∞`;
                document.getElementById('feelsLike').textContent = `${Math.round(data.main.feels_like)}¬∞`;
                document.getElementById('wind').textContent = `${data.wind.speed} m/s`;
                document.getElementById('humidity').textContent = `${data.main.humidity}%`;
                
                // –≠–º–æ–¥–∑–∏
                const weatherId = data.weather[0].id;
                let emoji = '‚òÄÔ∏è';
                if (weatherId >= 200 && weatherId < 300) emoji = '‚õàÔ∏è';
                else if (weatherId >= 300 && weatherId < 400) emoji = 'üåßÔ∏è';
                else if (weatherId >= 500 && weatherId < 600) emoji = 'üå¶Ô∏è';
                else if (weatherId >= 600 && weatherId < 700) emoji = '‚ùÑÔ∏è';
                else if (weatherId >= 700 && weatherId < 800) emoji = 'üå´Ô∏è';
                else if (weatherId === 800) emoji = '‚òÄÔ∏è';
                else if (weatherId > 800) emoji = '‚òÅÔ∏è';
                
                const description = data.weather[0].description;
                document.getElementById('description').innerHTML = 
                    `<span>${emoji}</span><span style="text-transform: capitalize;">${description}</span>`;
                
                document.getElementById('status').innerHTML = 'üìé Weather ¬∑ Updated just now';
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
                if (window.Telegram?.WebApp) {
                    Telegram.WebApp.sendData(JSON.stringify({
                        city: data.name,
                        temp: Math.round(data.main.temp),
                        weather: description
                    }));
                }
                
            } catch (error) {
                document.getElementById('status').innerHTML = '‚ùå City not found';
                document.getElementById('cityName').textContent = 'Error';
            }
        }

        // Enter key
        document.getElementById('cityInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') getWeather();
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–≥–æ–¥—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        window.onload = () => {
            selectCity('Kyiv');
        };
    </script>
</body>
</html>
